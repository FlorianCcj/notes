[Unit]
Description=LDAP Admin
After=ldap-server.service
Requires=ldap-server.service

[Service]
Restart=on-failure
ExecStartPre=-/usr/bin/docker kill ldap-admin
ExecStartPre=-/usr/bin/docker rm ldap-admin
ExecStart=/usr/bin/docker run \
  --rm \
  --name ldap-admin \
  --hostname ldap-admin \
  --link ldap_server:{{ mlf_network_name }} \
  --env PHPLDAPADMIN_LDAP_HOSTS={{ mlf_network_name }} \
  --env PHPLDAPADMIN_HTTPS=false \
  -p {{ ldap_admin_port_host_https }}:443 \
  -p {{ ldap_admin_port_host_http }}:80 \
  {{ ldap_admin_image_name }}:{{ ldap_admin_image_tag }} --loglevel debug
ExecStop=/usr/bin/docker stop ldap-admin
ExecStopPost=-/usr/bin/docker rm ldap-admin

[Install]
WantedBy=multi-user.target
